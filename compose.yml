services:
  config-service:
    build: .
    command: uv run --with fastapi -- fastapi dev services/config-server/app/main.py --host 0.0.0.0 --port 8000
    volumes:
      - ./services/config-server:/app/services/config-server
    ports:
      - "8003:8000"

  gateway-service:
    build: .
    command: uv run --package gateway --with fastapi -- fastapi dev services/gateway/app/main.py --host 0.0.0.0 --port 8000
    depends_on:
      - config-service
      - weather-data-service
      - flow-data-service
    ports:
      - "8000:8000"
    volumes:
      - ./services/gateway:/app/services/gateway

  weather-data-service:
    build: .
    command: uv run --package weather-data --with fastapi -- fastapi dev services/weather-data/app/main.py --host 0.0.0.0 --port 8000
    depends_on:
      - config-service
    ports:
      - "8001:8000"
    volumes:
      - ./services/weather-data:/app/services/weather-data

  flow-data-service:
    build: .
    command: uv run --package flow-data --with fastapi -- fastapi dev services/flow-data/app/main.py --host 0.0.0.0 --port 8000
    depends_on:
      - config-service
    ports:
      - "8002:8000"
    volumes:
      - ./services/flow-data:/app/services/flow-data
